# Uses apt-get to install system-wide dependencies.

# If using Ubuntu 13.04, you may discover that some repositories are missing.
# See this for details:
# https://gist.github.com/dergachev/f5da514802fcbbb441a1
- name: Handle Ubuntu 13.04 end of life.
  shell: sed -i.bak -r 's/(archive|security).ubuntu.com/old-releases.ubuntu.com/g' /etc/apt/sources.list
  when: ansible_distribution == 'Ubuntu' and ansible_distribution_version == '13.04'
  become: true
  become_method: sudo

- name: safe-upgrade
  apt:
    upgrade: dist
  become: true
  become_method: sudo

- name: Install base Ubuntu packages
  apt: pkg={{ item }} state=present update_cache=yes
  with_items:
    - git
    - build-essential
    - cmake
    - wget
    - libc6:i386
    - libstdc++6:i386
  become: true
  become_method: sudo

- name: Update APT repo cache
  apt: update_cache=yes
  become: true
  become_method: sudo

# Set up conditional installation for ARM GCC tooling later.
- name: Checking for arm gcc
  shell: which arm-none-eabi-gcc 2>&1 1>/dev/null && echo y || echo n
  register: armgcc
